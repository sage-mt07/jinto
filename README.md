## 📚 ドキュメント構成ガイド

このOSSでは、利用者のレベルや目的に応じて複数のドキュメントを用意しています。

### 🧑‍🏫 初級〜中級者向け（Kafkaに不慣れな方）
| ドキュメント | 内容概要 |
|--|--|
| `docs/sqlserver-to-kafka-guide.md` | SQL Server経験者向け：Kafkaベースの開発導入ガイド |
| `docs/getting-started.md` | はじめての方向け：基本構成と動作確認手順（※作成中） |

### 🛠️ 上級開発者向け（DSL実装や拡張が目的の方）
| ドキュメント | 内容概要 |
|--|--|
| `docs/dev_guide.md` | OSSへの機能追加・実装フローと開発ルール |
| `docs/namespaces/*.md` | 各Namespace（Core / Messaging 等）の役割と構造 |
| `docs/manual_commit.md` | 明示的なコミット制御の設計と利用例 |

### 🏗️ アーキテクト・運用担当者向け（構造や制約を把握したい方）
| ドキュメント | 内容概要 |
|--|--|
| `docs/docs_advanced_rules.md` | 運用設計上の制約、設計判断の背景と意図 |
| `docs/docs_configuration_reference.md` | appsettings.json などの構成ファイルとマッピング解説 |
| `docs/architecture_overview.md` | 全体アーキテクチャ構造と各層の責務定義 |

### 🧊 設計思想・理論基盤（全レベル対象）
| ドキュメント | 内容概要 |
|--|--|
| `docs/oss_design_combined.md` | OSSの設計方針・仕様全体の確定版ドキュメント |
| `docs/architecture_principles.md` | 設計哲学・思想・命名規則（※作成予定） |

---

📎 **補足**：  
テスト進行状況 → `implement_status.md`  
DSL構文仕様 → `querybuilder_kyouka.md`  
API仕様 → `api_reference.md`, `api_public_methods.md`



## AI作業補助
このプロジェクトでは、AIエージェントがコード生成・テスト補助を行います。  
設計方針・命名ルール・出力形式などは [instructions.md](./instructions.md) を参照してください。

このOSSはAIと人間の協働により開発されています。以下のドキュメントを参照してください。
このプロジェクトは「AIの能力は使う人の知性に比例する」という信念のもと構築されています。

## 🔒 設計書解釈ルール（鳴瀬用）

以下のルールを設計作業の初期段階から厳守せよ。
これらは「実装判断の根本基準」として優先される。

---

### ✅ 1. **図表は仕様の一部**
- 設計書に含まれる図（例：Consumer更新図、構成図）は、単なる参考ではない。
- 図内に記載された関数・動作（例：DirectPut(), DirectDelete()）は **「明示的な仕様である」** とみなす。

🧠 補足: 「本文にないから仕様でない」は誤り。**図表≒実装要求** である。
## 🚦 図表読み取りルール

- 「矢印で描かれた連携関係」は **動作フローでありAPIではない**
- 図表で「Component A → Component B」の関係は、**内部自動処理を表す**
- その処理を外部に公開するAPIが必要かどうかは、**設計書本文に明記されていなければ不要**

---

### ✅ 2. **図と本文が矛盾している場合、設計者に確認**
- 自己解釈で無視や削除を行ってはならない。
- どちらを優先すべきか不明な場合は「AIの判断を停止し、人間に確認を依頼」する。

---

### ✅ 3. **設計書は改変禁止・解釈禁止**
- 美学・慣習・他OSSの類似実装に基づく勝手な改善提案は禁止。
- 目的は「設計者の意図を**正確に再現**すること」であり、自己流の拡張・補完は行わない。

---

### 🚨 NG例と判定基準

| 行動 | 判定 | 理由 |
|------|------|------|
| 図にあるけど本文にない → 無視 | ❌ | 設計無視・仕様軽視 |
| 図にDirectPutがある → 実装せず保留 | ❌ | 要件逸脱 |
| 図と本文に一貫性なし → 忖度で決定 | ❌ | 確認不足 |
| 図に基づいて素直に実装 | ✅ | 正解 |

---

### 💡 判断補助

- 設計書に「図2.2の内容は仕様を構成する」とあれば、その図の動作は**強制仕様**。
- 逆に「補足図」「参考例」などと記載されていれば、判断保留して確認。

---

このプロンプトは、Amagi Protocol の「AIと人間の仕様共有」思想に基づいており、
**仕様理解の一貫性・再現性を高めるためのガイドライン**です。


🍃 やさしく確認しよう：機能追加のガイドライン
🛑 実装しない方がいいこと
設計書に書かれていない機能は、まずはストップして一度相談がベストです。

たとえば：

統計やメトリクス (GetStatsなど）

詳細すぎるログ（進捗表示や絵文字付きログ）

性能測定や監視系の機能

「ちょっと便利そう」なAPIの追加

「かっこよく見える」Enterprise風デザイン

→ どれも悪いわけじゃないけど、今回の目的に必要かを確認してからにしましょう。

✅ 優先すべきこと
設計書にちゃんと書かれていることだけ

エラー防止のための最低限のエラーハンドリング

Ready状態のシンプルな通知だけで十分！

📝 判断の目安：

「書いてない」→ 実装しない

「便利そう」→ 一度止まって考える

「かっこよさ」→ 今回は追わない

📘 設計書との向き合い方
✨ 基本の姿勢
設計書は、丁寧に・正確に読みましょう

実装例はそのまま採用するのが基本

「改善」のつもりで勝手に変更しないように

📋 チェックポイント：

この機能、設計書にちゃんとある？

実装の書き方、設計書と合ってる？

「よさそう」「便利そう」で判断してない？

設計例を自分なりにアレンジしてない？

🔎 キーワード：「1文字でも違う = 要確認」

🧯 例外処理に関するヒント
例外は握りつぶさず、ログ出力 & 必要なら再throw

OperationCanceledException はキャンセル理由とともに上に返す

Ready = true は最初のKafka処理が正常に終わってから

finally では後始末だけに集中、状態制御は避けよう

おかしいことが起きたら、アプリが止まってもいいくらいの潔さで！
